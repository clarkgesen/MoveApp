const apiKey="ee316b84f88a186c92a6e31cd2dad1d8";let city,cityLat,cityLong,removedCity,cityArray=[];function renderList(){Object.values(storedCities).forEach(t=>{const i=$("<li>",{class:"list-group-item"});i.text(t.name),$(".list-group").prepend(i)})}function currentCall(){const t=`https://api.openweathermap.org/data/2.5/weather?q=${city}&appid=${apiKey}&units=imperial`;$.ajax({url:t,method:"GET"}).then(t=>{$("<li>",{class:"list-group-item"});const e=`http://openweathermap.org/img/w/${t.weather[0].icon}.png`;if(cityObject={name:t.name},null===(cityArray=JSON.parse(localStorage.getItem("cities"))))localStorage.setItem("cities",JSON.stringify([cityObject]));else;null!==cityArray&&function(){for(i=0;i<cityArray.length;i++)cityArray[i].name===cityObject.name&&(removedCity=cityArray.splice([i],1));cityArray.unshift(cityObject),localStorage.setItem("cities",JSON.stringify(cityArray))}(),$(".city").text(t.name),$(".temp").text(`Temp: ${t.main.temp}`),$(".humidity").text(`Humidity: ${t.main.humidity}`),$(".windSpeed").text(`Wind: ${t.wind.speed}`),$("#icon").attr("src",e),cityLat=t.coord.lat,cityLong=t.coord.lon,cityId=t.id;const a=`https://api.openweathermap.org/data/2.5/uvi?appid=${apiKey}&lat=${cityLat}&lon=${cityLong}&units=imperial`;$.ajax({url:a,method:"GET"}).then(t=>{$(".uvIndex").text(`UVI: ${t.value}`);const i=$("<h2>"),e=t.date_iso.substr(0,t.date_iso.indexOf("T"));i.text(e),$("h1").append(i)});const n=`https://api.openweathermap.org/data/2.5/forecast?appid=${apiKey}&id=${cityId}&units=imperial`;let r=3;$.ajax({url:n,method:"GET"}).then(t=>{for(let i=4;i<t.list.length;i+=8){const e=`http://openweathermap.org/img/w/${t.list[i].weather[0].icon}.png`,a=t.list[i].dt_txt.substr(0,t.list[i].dt_txt.indexOf(" "));$(`#day-${r}`).text(a),$(`#temp-${r}`).text(`Temp: ${t.list[i].main.temp}`),$(`#humid-${r}`).text(`Humidity: ${t.list[i].main.humidity}`),$(`#icon-${r}`).attr("src",e),r+=8}})})}storedCities=JSON.parse(localStorage.getItem("cities")),null!==storedCities&&(city=storedCities[0].name,window.onload=currentCall(city)),null!==storedCities&&renderList(),$("#searchButton").on("click",function(){city=$(this).parent("div").children("div").children("input").val(),$(this).parent("div").children("div").children("input").val(""),currentCall()}),$(document).on("click","li",function(){city=$(this).text(),currentCall()});